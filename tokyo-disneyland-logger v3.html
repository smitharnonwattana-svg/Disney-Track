<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üè∞ TDL ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&family=Prompt:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --pink:#FF4F7B; --pink-light:#FF8FAB; --pink-pale:#FFE0E8;
    --gold:#FFB800; --gold-light:#FFD966; --gold-pale:#FFF3CC;
    --navy:#1A1F3A; --navy-mid:#2D3561;
    --teal:#00C2B2; --teal-light:#7EEEE7; --teal-pale:#E0FAF8;
    --purple:#7C5CBF; --purple-pale:#EDE8F8;
    --cream:#FFF9F5; --white:#FFFFFF;
    --gray:#8892A4; --light-gray:#F0F2F7;
    --shadow:0 4px 24px rgba(26,31,58,0.10);
    --shadow-lg:0 8px 40px rgba(26,31,58,0.16);
  }
  *{box-sizing:border-box;margin:0;padding:0;}
  body{font-family:'Sarabun',sans-serif;background:var(--cream);color:var(--navy);min-height:100vh;overflow-x:hidden;}

  /* HEADER */
  .header{background:linear-gradient(135deg,var(--navy) 0%,var(--navy-mid) 60%,#3D2B6B 100%);padding:18px 16px 24px;text-align:center;position:relative;overflow:hidden;}
  .header::before{content:'';position:absolute;inset:0;background:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffffff' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/svg%3E");}
  .castle-icon{font-size:34px;margin-bottom:3px;animation:float 3s ease-in-out infinite;display:block;}
  @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
  .header h1{font-family:'Prompt',sans-serif;font-size:21px;font-weight:700;color:var(--white);}
  .header .subtitle{font-size:12px;color:var(--gold-light);margin-top:2px;font-weight:300;}
  .date-display{display:inline-block;background:rgba(255,255,255,0.12);border:1px solid rgba(255,255,255,0.2);color:var(--white);font-size:11px;padding:3px 12px;border-radius:20px;margin-top:7px;backdrop-filter:blur(8px);}

  /* TABS */
  .nav-tabs{display:flex;background:var(--white);border-bottom:2px solid var(--light-gray);overflow-x:auto;scrollbar-width:none;position:sticky;top:0;z-index:100;box-shadow:0 2px 12px rgba(0,0,0,0.06);}
  .nav-tabs::-webkit-scrollbar{display:none;}
  .tab-btn{flex:1;min-width:60px;padding:9px 4px 7px;border:none;background:transparent;cursor:pointer;font-family:'Sarabun',sans-serif;font-size:10px;font-weight:700;color:var(--gray);display:flex;flex-direction:column;align-items:center;gap:2px;border-bottom:3px solid transparent;transition:all 0.2s;white-space:nowrap;}
  .tab-btn .tab-icon{font-size:17px;}
  .tab-btn.active{color:var(--pink);border-bottom-color:var(--pink);}

  /* PAGES */
  .page{display:none;padding:14px;animation:fadeIn 0.3s ease;}
  .page.active{display:block;}
  @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

  /* CARDS */
  .section-card{background:var(--white);border-radius:16px;padding:15px;margin-bottom:13px;box-shadow:var(--shadow);}
  .section-title{font-family:'Prompt',sans-serif;font-size:15px;font-weight:600;color:var(--navy);margin-bottom:13px;display:flex;align-items:center;gap:7px;}

  /* FORMS */
  .form-row{margin-bottom:11px;}
  .form-label{display:block;font-size:11px;font-weight:700;color:var(--gray);margin-bottom:4px;text-transform:uppercase;letter-spacing:0.5px;}
  .form-input,.form-select,.form-textarea{width:100%;padding:9px 11px;border:2px solid var(--light-gray);border-radius:10px;font-family:'Sarabun',sans-serif;font-size:14px;color:var(--navy);background:var(--cream);transition:border-color 0.2s;outline:none;}
  .form-input:focus,.form-select:focus,.form-textarea:focus{border-color:var(--pink);background:var(--white);}
  .form-textarea{resize:vertical;min-height:65px;}
  .form-row-2{display:grid;grid-template-columns:1fr 1fr;gap:9px;}
  .form-row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;}

  /* TYPE SELECTOR */
  .type-selector{display:flex;gap:7px;margin-top:4px;}
  .type-btn{flex:1;padding:9px 6px;border-radius:10px;border:2px solid var(--light-gray);background:var(--cream);cursor:pointer;font-family:'Sarabun',sans-serif;font-size:11px;font-weight:700;color:var(--gray);text-align:center;transition:all 0.2s;display:flex;flex-direction:column;align-items:center;gap:3px;}
  .type-btn .t-icon{font-size:20px;}
  .type-btn.active-ride{border-color:var(--pink);background:var(--pink-pale);color:var(--pink);}
  .type-btn.active-show{border-color:var(--teal);background:var(--teal-pale);color:var(--teal);}
  .type-btn.active-food{border-color:var(--gold);background:var(--gold-pale);color:#B07D00;}
  .type-btn.active-expense{border-color:var(--purple);background:var(--purple-pale);color:var(--purple);}

  /* ZONE PILLS */
  .zone-grid{display:flex;flex-wrap:wrap;gap:7px;margin-top:4px;}
  .zone-pill{padding:7px 13px;border-radius:20px;border:2px solid var(--light-gray);background:var(--cream);cursor:pointer;font-family:'Sarabun',sans-serif;font-size:12px;font-weight:700;color:var(--gray);transition:all 0.18s;white-space:nowrap;}
  .zone-pill:hover{border-color:var(--pink-light);color:var(--pink);}
  .zone-pill.selected{background:var(--pink-pale);border-color:var(--pink);color:var(--pink);}
  .zone-pill.zone-food.selected{background:var(--gold-pale);border-color:var(--gold);color:#B07D00;}

  /* RIDE LIST */
  .ride-list{display:flex;flex-direction:column;gap:7px;margin-top:4px;max-height:280px;overflow-y:auto;}
  .ride-option{padding:10px 12px;border-radius:10px;border:2px solid var(--light-gray);background:var(--cream);cursor:pointer;transition:all 0.18s;}
  .ride-option:hover{border-color:var(--pink-light);}
  .ride-option.selected{background:var(--pink-pale);border-color:var(--pink);}
  .ride-option-name{font-weight:700;font-size:13px;color:var(--navy);}
  .ride-option-meta{font-size:11px;color:var(--gray);margin-top:2px;display:flex;gap:8px;flex-wrap:wrap;}
  .ride-option-meta .wait-badge{background:var(--pink-pale);color:var(--pink);padding:1px 7px;border-radius:5px;font-weight:700;}
  .ride-option-meta .status-badge{background:#FFF3CC;color:#B07D00;padding:1px 7px;border-radius:5px;font-weight:700;}
  .ride-option.food-option.selected{background:var(--gold-pale);border-color:var(--gold);}

  /* STARS */
  .star-row{display:flex;gap:8px;margin-top:4px;justify-content:center;}
  .star-btn{font-size:30px;cursor:pointer;transition:transform 0.15s;filter:grayscale(1);opacity:0.3;background:none;border:none;line-height:1;}
  .star-btn.active{filter:none;opacity:1;transform:scale(1.1);}
  .star-btn:hover{transform:scale(1.2);filter:none;opacity:0.8;}
  .rating-display{text-align:center;font-size:13px;color:var(--gray);margin-top:4px;min-height:20px;}

  /* FEELINGS */
  .feeling-row{display:flex;gap:6px;flex-wrap:wrap;justify-content:center;}
  .feeling-btn{display:flex;flex-direction:column;align-items:center;gap:2px;padding:7px 6px;border-radius:10px;border:2px solid transparent;cursor:pointer;background:var(--light-gray);transition:all 0.15s;min-width:44px;}
  .feeling-btn .f-emoji{font-size:22px;line-height:1;}
  .feeling-btn .f-label{font-size:9px;font-weight:700;color:var(--gray);white-space:nowrap;}
  .feeling-btn.active{background:var(--pink-pale);border-color:var(--pink);transform:scale(1.08);}
  .feeling-btn.active .f-label{color:var(--pink);}

  /* BUTTONS */
  .btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:11px 18px;border-radius:12px;border:none;font-family:'Sarabun',sans-serif;font-size:14px;font-weight:700;cursor:pointer;transition:all 0.2s;width:100%;}
  .btn-primary{background:linear-gradient(135deg,var(--pink),#FF2D6F);color:var(--white);box-shadow:0 4px 14px rgba(255,79,123,0.35);}
  .btn-primary:active{transform:scale(0.97);}
  .btn-teal{background:linear-gradient(135deg,var(--teal),#00A896);color:var(--white);box-shadow:0 4px 14px rgba(0,194,178,0.3);}
  .btn-gold{background:linear-gradient(135deg,var(--gold),#FF9500);color:var(--white);box-shadow:0 4px 14px rgba(255,184,0,0.3);}
  .btn-purple{background:linear-gradient(135deg,var(--purple),#5B3FA0);color:var(--white);box-shadow:0 4px 14px rgba(124,92,191,0.3);}
  .btn-secondary{background:var(--light-gray);color:var(--navy);}

  /* WAIT SLIDER */
  .wait-slider{width:100%;accent-color:var(--pink);height:4px;}
  .wait-display{text-align:center;font-family:'Prompt',sans-serif;font-size:26px;font-weight:700;color:var(--pink);margin:3px 0;}

  /* CURRENCY */
  .currency-row{display:flex;gap:8px;align-items:flex-end;}
  .currency-input-wrap{flex:1;}
  .currency-toggle{display:flex;border-radius:10px;overflow:hidden;border:2px solid var(--light-gray);}
  .cur-btn{flex:1;padding:8px 10px;border:none;background:var(--cream);font-family:'Sarabun',sans-serif;font-size:13px;font-weight:700;cursor:pointer;transition:all 0.2s;color:var(--gray);}
  .cur-btn.active{background:var(--navy);color:var(--white);}
  .rate-info{font-size:11px;color:var(--gray);margin-top:4px;text-align:right;}

  /* LOG ITEMS */
  .log-item{background:var(--cream);border-radius:12px;padding:11px;margin-bottom:9px;border-left:4px solid var(--pink);position:relative;animation:slideIn 0.3s ease;}
  @keyframes slideIn{from{opacity:0;transform:translateX(-10px)}to{opacity:1;transform:translateX(0)}}
  .log-item.show-type{border-left-color:var(--teal);}
  .log-item.food-type{border-left-color:var(--gold);}
  .log-item.expense-type{border-left-color:var(--purple);}
  .log-item-header{display:flex;justify-content:space-between;align-items:flex-start;padding-right:22px;}
  .log-item-title{font-weight:700;font-size:14px;color:var(--navy);}
  .log-item-time{font-size:11px;color:var(--gray);background:var(--white);padding:2px 7px;border-radius:6px;white-space:nowrap;}
  .log-item-meta{margin-top:5px;display:flex;gap:6px;flex-wrap:wrap;align-items:center;}
  .badge{font-size:10px;font-weight:700;padding:2px 7px;border-radius:6px;display:inline-flex;align-items:center;gap:3px;}
  .badge-pink{background:var(--pink-pale);color:var(--pink);}
  .badge-teal{background:var(--teal-pale);color:var(--teal);}
  .badge-gold{background:var(--gold-pale);color:#B07D00;}
  .badge-navy{background:#E8EAFF;color:var(--navy-mid);}
  .badge-purple{background:var(--purple-pale);color:var(--purple);}
  .log-item-note{font-size:12px;color:var(--gray);margin-top:4px;font-style:italic;}
  .log-delete-btn{position:absolute;top:9px;right:9px;background:none;border:none;cursor:pointer;font-size:13px;opacity:0.35;transition:opacity 0.2s;}
  .log-delete-btn:hover{opacity:1;}

  /* TIMELINE */
  .timeline{position:relative;padding-left:20px;}
  .timeline::before{content:'';position:absolute;left:8px;top:0;bottom:0;width:2px;background:linear-gradient(to bottom,var(--pink),var(--teal),var(--gold));border-radius:2px;}
  .timeline-item{position:relative;margin-bottom:14px;}
  .timeline-dot{position:absolute;left:-18px;top:11px;width:12px;height:12px;border-radius:50%;background:var(--pink);border:2px solid var(--white);box-shadow:0 0 0 2px var(--pink);}
  .timeline-dot.show{background:var(--teal);box-shadow:0 0 0 2px var(--teal);}
  .timeline-dot.food{background:var(--gold);box-shadow:0 0 0 2px var(--gold);}
  .timeline-dot.expense{background:var(--purple);box-shadow:0 0 0 2px var(--purple);}

  /* SUMMARY */
  .summary-grid{display:grid;grid-template-columns:1fr 1fr;gap:9px;margin-bottom:13px;}
  .summary-stat{background:linear-gradient(135deg,var(--navy),var(--navy-mid));color:var(--white);border-radius:14px;padding:13px 11px;text-align:center;}
  .summary-stat .stat-num{font-family:'Prompt',sans-serif;font-size:26px;font-weight:700;color:var(--gold-light);line-height:1;}
  .summary-stat .stat-label{font-size:11px;opacity:0.7;margin-top:3px;}
  .expense-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--light-gray);font-size:13px;}
  .expense-row:last-child{border-bottom:none;}
  .expense-cat{display:flex;align-items:center;gap:6px;font-weight:600;}
  .expense-amount{font-weight:700;color:var(--pink);}
  .expense-bar{background:var(--light-gray);border-radius:8px;overflow:hidden;height:7px;margin-top:5px;}
  .expense-fill{height:100%;border-radius:8px;background:linear-gradient(90deg,var(--pink),var(--gold));transition:width 0.6s ease;}

  /* EXPORT */
  .export-preview{background:var(--navy);color:var(--white);border-radius:14px;padding:15px;font-size:12px;font-family:monospace;line-height:1.8;white-space:pre-wrap;word-break:break-word;max-height:280px;overflow-y:auto;margin-bottom:11px;}

  /* EMPTY STATE */
  .empty-state{text-align:center;padding:36px 20px;color:var(--gray);}
  .empty-state .empty-icon{font-size:44px;margin-bottom:9px;opacity:0.5;}
  .empty-state p{font-size:13px;}

  /* TOAST */
  .toast{position:fixed;bottom:76px;left:50%;transform:translateX(-50%) translateY(20px);background:var(--navy);color:var(--white);padding:9px 20px;border-radius:20px;font-size:13px;font-weight:700;opacity:0;transition:all 0.3s;z-index:9999;white-space:nowrap;box-shadow:var(--shadow-lg);}
  .toast.show{opacity:1;transform:translateX(-50%) translateY(0);}

  /* EXCHANGE RATE */
  .rate-card{background:linear-gradient(135deg,#1A1F3A,#2D3561);border-radius:12px;padding:12px 14px;margin-bottom:11px;display:flex;justify-content:space-between;align-items:center;}
  .rate-card .rate-label{color:rgba(255,255,255,0.7);font-size:12px;}
  .rate-card .rate-value{color:var(--gold-light);font-family:'Prompt',sans-serif;font-size:16px;font-weight:700;}
  .rate-edit{color:var(--teal-light);font-size:11px;cursor:pointer;text-decoration:underline;}

  .divider{height:1px;background:var(--light-gray);margin:10px 0;}
  .section-sub{font-size:12px;font-weight:700;color:var(--gray);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:8px;}
</style>
</head>
<body>

<div class="header">
  <span class="castle-icon">üè∞</span>
  <h1>Tokyo Disneyland</h1>
  <div class="subtitle">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥</div>
  <div class="date-display" id="currentDate">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
</div>

<div class="nav-tabs">
  <button class="tab-btn active" onclick="showTab('add')" id="tab-add"><span class="tab-icon">‚úèÔ∏è</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
  <button class="tab-btn" onclick="showTab('timeline')" id="tab-timeline"><span class="tab-icon">‚è±Ô∏è</span>Timeline</button>
  <button class="tab-btn" onclick="showTab('summary')" id="tab-summary"><span class="tab-icon">üìä</span>‡∏™‡∏£‡∏∏‡∏õ</button>
  <button class="tab-btn" onclick="showTab('export')" id="tab-export"><span class="tab-icon">üì§</span>Export</button>
</div>

<!-- ===== PAGE: ADD ===== -->
<div class="page active" id="page-add">
  <div class="type-selector">
    <button class="type-btn active-ride" id="type-ride" onclick="selectType('ride')"><span class="t-icon">üé¢</span>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô</button>
    <button class="type-btn" id="type-show" onclick="selectType('show')"><span class="t-icon">üé≠</span>‡πÇ‡∏ä‡∏ß‡πå</button>
    <button class="type-btn" id="type-food" onclick="selectType('food')"><span class="t-icon">üçú</span>‡∏≠‡∏≤‡∏´‡∏≤‡∏£</button>
    <button class="type-btn" id="type-expense" onclick="selectType('expense')"><span class="t-icon">üí¥</span>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</button>
  </div>

  <!-- RIDE FORM -->
  <div id="form-ride">
    <div class="section-card">
      <div class="section-title"><span>üé¢</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô</div>

      <!-- Step 1: Zone -->
      <div class="form-row" id="ride-step1">
        <label class="form-label">‚ë† ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô</label>
        <div class="zone-grid" id="ride-zone-grid">
          <div class="zone-pill" onclick="selectRideZone('World Bazaar')">üó∫Ô∏è World Bazaar</div>
          <div class="zone-pill" onclick="selectRideZone('Adventureland')">üå¥ Adventureland</div>
          <div class="zone-pill" onclick="selectRideZone('Westernland')">ü§† Westernland</div>
          <div class="zone-pill" onclick="selectRideZone('Critter Country')">ü¶¶ Critter Country</div>
          <div class="zone-pill" onclick="selectRideZone('Fantasyland')">üè∞ Fantasyland</div>
          <div class="zone-pill" onclick="selectRideZone('Toontown')">üé® Toontown</div>
          <div class="zone-pill" onclick="selectRideZone('Tomorrowland')">üöÄ Tomorrowland</div>
        </div>
      </div>

      <!-- Step 2: Ride pick -->
      <div class="form-row" id="ride-step2" style="display:none">
        <label class="form-label">‚ë° ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô <span id="ride-zone-label" style="color:var(--pink);font-size:12px;"></span> <button onclick="resetRideZone()" style="background:none;border:none;cursor:pointer;font-size:11px;color:var(--gray);text-decoration:underline;">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏ã‡∏ô</button></label>
        <div class="ride-list" id="ride-option-list"></div>
        <div class="form-row" style="margin-top:8px;margin-bottom:0">
          <input class="form-input" id="ride-name-custom" placeholder="‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏á..." style="display:none"/>
        </div>
      </div>

      <!-- Step 3: Details (shown after ride selected) -->
      <div id="ride-details" style="display:none">
        <div class="divider"></div>
        <div class="form-row-2">
          <div>
            <label class="form-label">‡πÄ‡∏ß‡∏•‡∏≤</label>
            <input type="time" class="form-input" id="ride-time"/>
          </div>
          <div>
            <label class="form-label">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</label>
            <input type="number" class="form-input" id="ride-order" placeholder="‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥" min="1"/>
          </div>
        </div>

        <div class="form-row">
          <label class="form-label">‚è≥ ‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≠: <span id="wait-val">0</span> ‡∏ô‡∏≤‡∏ó‡∏µ</label>
          <div class="wait-display" id="wait-show">‡πÑ‡∏°‡πà‡∏£‡∏≠‡πÄ‡∏•‡∏¢ üéâ</div>
          <input type="range" class="wait-slider" id="ride-wait" min="0" max="180" step="5" value="0" oninput="updateWait(this.value)"/>
          <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--gray);margin-top:2px">
            <span>0</span><span>30‡∏ô.</span><span>60‡∏ô.</span><span>120‡∏ô.</span><span>180‡∏ô.</span>
          </div>
        </div>

        <div class="form-row">
          <label class="form-label">‚≠ê ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≠‡∏ö</label>
          <div class="star-row" id="ride-stars">
            <button class="star-btn" onclick="setStars(1,'ride')" data-v="1">‚≠ê</button>
            <button class="star-btn" onclick="setStars(2,'ride')" data-v="2">‚≠ê</button>
            <button class="star-btn" onclick="setStars(3,'ride')" data-v="3">‚≠ê</button>
            <button class="star-btn" onclick="setStars(4,'ride')" data-v="4">‚≠ê</button>
            <button class="star-btn" onclick="setStars(5,'ride')" data-v="5">‚≠ê</button>
          </div>
          <div class="rating-display" id="ride-rating-label">‡πÅ‡∏ï‡∏∞‡∏î‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
        </div>

        <div class="form-row">
          <label class="form-label">üòÑ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å</label>
          <div class="feeling-row" id="ride-feelings">
            <button class="feeling-btn" onclick="setFeeling('ride','üò®','‡∏Å‡∏•‡∏±‡∏ß‡∏°‡∏≤‡∏Å')"><span class="f-emoji">üò®</span><span class="f-label">‡∏Å‡∏•‡∏±‡∏ß‡∏°‡∏≤‡∏Å</span></button>
            <button class="feeling-btn" onclick="setFeeling('ride','üòµ','‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏´‡∏±‡∏ß')"><span class="f-emoji">üòµ</span><span class="f-label">‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏´‡∏±‡∏ß</span></button>
            <button class="feeling-btn" onclick="setFeeling('ride','üòê','‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤')"><span class="f-emoji">üòê</span><span class="f-label">‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</span></button>
            <button class="feeling-btn" onclick="setFeeling('ride','üòä','‡∏î‡∏µ')"><span class="f-emoji">üòä</span><span class="f-label">‡∏î‡∏µ</span></button>
            <button class="feeling-btn" onclick="setFeeling('ride','üòÑ','‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏≤‡∏Å')"><span class="f-emoji">üòÑ</span><span class="f-label">‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏≤‡∏Å</span></button>
            <button class="feeling-btn" onclick="setFeeling('ride','ü§©','‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î!')"><span class="f-emoji">ü§©</span><span class="f-label">‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î!</span></button>
            <button class="feeling-btn" onclick="setFeeling('ride','üò±','‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô!')"><span class="f-emoji">üò±</span><span class="f-label">‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô!</span></button>
          </div>
        </div>

        <div class="form-row">
          <label class="form-label">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</label>
          <textarea class="form-textarea" id="ride-note" placeholder="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏à‡∏î‡∏à‡∏≥..."></textarea>
        </div>

        <button class="btn btn-primary" onclick="saveRide()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô</button>
      </div>
    </div>
  </div>

  <!-- SHOW FORM -->
  <div id="form-show" style="display:none">
    <div class="section-card">
      <div class="section-title"><span>üé≠</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏ä‡∏ß‡πå / Parade</div>

      <div class="form-row">
        <label class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ä‡∏ß‡πå</label>
        <div class="ride-list" id="show-option-list" style="max-height:220px;">
        </div>
        <input class="form-input" id="show-name-custom" placeholder="‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏á..." style="margin-top:8px"/>
      </div>

      <div id="show-details">
        <div class="form-row-2">
          <div>
            <label class="form-label">‡πÄ‡∏ß‡∏•‡∏≤</label>
            <input type="time" class="form-input" id="show-time"/>
          </div>
          <div>
            <label class="form-label">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ô‡∏≤‡∏ó‡∏µ)</label>
            <input type="number" class="form-input" id="show-duration" placeholder="‡πÄ‡∏ä‡πà‡∏ô 30" min="1"/>
          </div>
        </div>

        <div class="form-row">
          <label class="form-label">‚≠ê ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≠‡∏ö</label>
          <div class="star-row" id="show-stars">
            <button class="star-btn" onclick="setStars(1,'show')">‚≠ê</button>
            <button class="star-btn" onclick="setStars(2,'show')">‚≠ê</button>
            <button class="star-btn" onclick="setStars(3,'show')">‚≠ê</button>
            <button class="star-btn" onclick="setStars(4,'show')">‚≠ê</button>
            <button class="star-btn" onclick="setStars(5,'show')">‚≠ê</button>
          </div>
          <div class="rating-display" id="show-rating-label">‡πÅ‡∏ï‡∏∞‡∏î‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
        </div>

        <div class="form-row">
          <label class="form-label">üòÑ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å</label>
          <div class="feeling-row" id="show-feelings">
            <button class="feeling-btn" onclick="setFeeling('show','ü•±','‡∏ô‡πà‡∏≤‡πÄ‡∏ö‡∏∑‡πà‡∏≠')"><span class="f-emoji">ü•±</span><span class="f-label">‡∏ô‡πà‡∏≤‡πÄ‡∏ö‡∏∑‡πà‡∏≠</span></button>
            <button class="feeling-btn" onclick="setFeeling('show','üòê','‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤')"><span class="f-emoji">üòê</span><span class="f-label">‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</span></button>
            <button class="feeling-btn" onclick="setFeeling('show','üòä','‡∏î‡∏µ')"><span class="f-emoji">üòä</span><span class="f-label">‡∏î‡∏µ</span></button>
            <button class="feeling-btn" onclick="setFeeling('show','üòÑ','‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏≤‡∏Å')"><span class="f-emoji">üòÑ</span><span class="f-label">‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏≤‡∏Å</span></button>
            <button class="feeling-btn" onclick="setFeeling('show','üò≠','‡∏ã‡∏≤‡∏ö‡∏ã‡∏∂‡πâ‡∏á')"><span class="f-emoji">üò≠</span><span class="f-label">‡∏ã‡∏≤‡∏ö‡∏ã‡∏∂‡πâ‡∏á</span></button>
            <button class="feeling-btn" onclick="setFeeling('show','ü§©','‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î!')"><span class="f-emoji">ü§©</span><span class="f-label">‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î!</span></button>
          </div>
        </div>

        <div class="form-row">
          <label class="form-label">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</label>
          <textarea class="form-textarea" id="show-note" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à..."></textarea>
        </div>
        <button class="btn btn-teal" onclick="saveShow()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏ä‡∏ß‡πå</button>
      </div>
    </div>
  </div>

  <!-- FOOD FORM -->
  <div id="form-food" style="display:none">
    <div class="section-card">
      <div class="section-title"><span>üçú</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</div>

      <!-- Zone -->
      <div class="form-row" id="food-step1">
        <label class="form-label">‚ë† ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô</label>
        <div class="zone-grid" id="food-zone-grid">
          <div class="zone-pill zone-food" onclick="selectFoodZone('World Bazaar')">üó∫Ô∏è World Bazaar</div>
          <div class="zone-pill zone-food" onclick="selectFoodZone('Adventureland')">üå¥ Adventureland</div>
          <div class="zone-pill zone-food" onclick="selectFoodZone('Westernland')">ü§† Westernland</div>
          <div class="zone-pill zone-food" onclick="selectFoodZone('Critter Country')">ü¶¶ Critter Country</div>
          <div class="zone-pill zone-food" onclick="selectFoodZone('Fantasyland')">üè∞ Fantasyland</div>
          <div class="zone-pill zone-food" onclick="selectFoodZone('Toontown')">üé® Toontown</div>
          <div class="zone-pill zone-food" onclick="selectFoodZone('Tomorrowland')">üöÄ Tomorrowland</div>
          <div class="zone-pill zone-food" onclick="selectFoodZone('‡∏ó‡∏±‡πà‡∏ß‡∏™‡∏ß‡∏ô')">üó∫Ô∏è ‡∏ó‡∏±‡πà‡∏ß‡∏™‡∏ß‡∏ô</div>
        </div>
      </div>

      <!-- Restaurant pick -->
      <div class="form-row" id="food-step2" style="display:none">
        <label class="form-label">‚ë° ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ <span id="food-zone-label" style="color:var(--gold);font-size:12px;"></span> <button onclick="resetFoodZone()" style="background:none;border:none;cursor:pointer;font-size:11px;color:var(--gray);text-decoration:underline;">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏ã‡∏ô</button></label>
        <div class="ride-list" id="food-option-list" style="max-height:220px;"></div>
      </div>

      <!-- Menu pick -->
      <div class="form-row" id="food-step3" style="display:none">
        <label class="form-label">‚ë¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π <button onclick="resetFoodRestaurant()" style="background:none;border:none;cursor:pointer;font-size:11px;color:var(--gray);text-decoration:underline;">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡πâ‡∏≤‡∏ô</button></label>
        <div class="ride-list" id="food-menu-list" style="max-height:180px;"></div>
        <input class="form-input" id="food-menu-custom" placeholder="‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏≠‡∏á..." style="margin-top:8px;display:none"/>
      </div>

      <!-- Food details -->
      <div id="food-details" style="display:none">
        <div class="divider"></div>
        <div class="form-row">
          <label class="form-label">üí¥ ‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
          <div class="currency-row">
            <div class="currency-input-wrap">
              <input type="number" class="form-input" id="food-price" placeholder="0" min="0"/>
            </div>
            <div class="currency-toggle">
              <button class="cur-btn active" id="food-cur-yen" onclick="setFoodCur('yen')">¬• JPY</button>
              <button class="cur-btn" id="food-cur-thb" onclick="setFoodCur('thb')">‡∏ø THB</button>
            </div>
          </div>
          <div class="rate-info" id="food-converted"></div>
        </div>

        <div class="form-row">
          <label class="form-label">‡πÄ‡∏ß‡∏•‡∏≤</label>
          <input type="time" class="form-input" id="food-time"/>
        </div>

        <div class="form-row">
          <label class="form-label">‚≠ê ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≠‡∏ö</label>
          <div class="star-row" id="food-stars">
            <button class="star-btn" onclick="setStars(1,'food')">‚≠ê</button>
            <button class="star-btn" onclick="setStars(2,'food')">‚≠ê</button>
            <button class="star-btn" onclick="setStars(3,'food')">‚≠ê</button>
            <button class="star-btn" onclick="setStars(4,'food')">‚≠ê</button>
            <button class="star-btn" onclick="setStars(5,'food')">‚≠ê</button>
          </div>
          <div class="rating-display" id="food-rating-label">‡πÅ‡∏ï‡∏∞‡∏î‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
        </div>

        <div class="form-row">
          <label class="form-label">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</label>
          <textarea class="form-textarea" id="food-note" placeholder="‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à ‡∏´‡∏£‡∏∑‡∏≠ must-try?"></textarea>
        </div>
        <button class="btn btn-gold" onclick="saveFood()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</button>
      </div>
    </div>
  </div>

  <!-- EXPENSE FORM -->
  <div id="form-expense" style="display:none">
    <div class="section-card">
      <div class="section-title"><span>üí¥</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</div>

      <div class="rate-card">
        <div><div class="rate-label">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</div><div class="rate-value">1 ¬• = <span id="rate-display">0.23</span> ‡∏ø</div></div>
        <span class="rate-edit" onclick="editRate()">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</span>
      </div>

      <div class="form-row">
        <label class="form-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</label>
        <input class="form-input" id="exp-name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å, Premier Access..."/>
      </div>

      <div class="form-row">
        <label class="form-label">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
        <select class="form-select" id="exp-cat">
          <option value="üõçÔ∏è ‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å">üõçÔ∏è ‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å</option>
          <option value="üéüÔ∏è Premier Access / DPA">üéüÔ∏è Premier Access / DPA</option>
          <option value="üéüÔ∏è Priority Pass">üéüÔ∏è Priority Pass</option>
          <option value="üçø ‡∏õ‡πä‡∏≠‡∏õ‡∏Ñ‡∏≠‡∏£‡πå‡∏ô/‡∏Ç‡∏ô‡∏°">üçø ‡∏õ‡πä‡∏≠‡∏õ‡∏Ñ‡∏≠‡∏£‡πå‡∏ô/‡∏Ç‡∏ô‡∏°</option>
          <option value="üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ / Photo">üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ / Photo</option>
          <option value="üöå ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á">üöå ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</option>
          <option value="üè® ‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°">üè® ‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°</option>
          <option value="üéÆ ‡πÄ‡∏Å‡∏° / Arcade">üéÆ ‡πÄ‡∏Å‡∏° / Arcade</option>
          <option value="üíä ‡∏¢‡∏≤ / ‡∏≠‡∏∑‡πà‡∏ô‡πÜ">üíä ‡∏¢‡∏≤ / ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
        </select>
      </div>

      <div class="form-row">
        <label class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</label>
        <div class="currency-row">
          <div class="currency-input-wrap">
            <input type="number" class="form-input" id="exp-price" placeholder="0" min="0" oninput="updateExpConverted()"/>
          </div>
          <div class="currency-toggle">
            <button class="cur-btn active" id="exp-cur-yen" onclick="setExpCur('yen')">¬• JPY</button>
            <button class="cur-btn" id="exp-cur-thb" onclick="setExpCur('thb')">‡∏ø THB</button>
          </div>
        </div>
        <div class="rate-info" id="exp-converted"></div>
      </div>

      <div class="form-row">
        <label class="form-label">‡πÄ‡∏ß‡∏•‡∏≤</label>
        <input type="time" class="form-input" id="exp-time"/>
      </div>

      <div class="form-row">
        <label class="form-label">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
        <input class="form-input" id="exp-note" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏ß"/>
      </div>

      <button class="btn btn-purple" onclick="saveExpense()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</button>
    </div>
  </div>
</div>

<!-- ===== PAGE: TIMELINE ===== -->
<div class="page" id="page-timeline">
  <div class="section-card">
    <div class="section-title"><span>‚è±Ô∏è</span>Timeline ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
    <div id="timeline-list"><div class="empty-state"><div class="empty-icon">üè∞</div><p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£<br>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢!</p></div></div>
  </div>
</div>

<!-- ===== PAGE: SUMMARY ===== -->
<div class="page" id="page-summary">
  <div class="summary-grid">
    <div class="summary-stat"><div class="stat-num" id="stat-rides">0</div><div class="stat-label">üé¢ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô</div></div>
    <div class="summary-stat"><div class="stat-num" id="stat-shows">0</div><div class="stat-label">üé≠ ‡πÇ‡∏ä‡∏ß‡πå</div></div>
    <div class="summary-stat"><div class="stat-num" id="stat-food">0</div><div class="stat-label">üçú ‡∏°‡∏∑‡πâ‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£</div></div>
    <div class="summary-stat"><div class="stat-num" id="stat-wait">0</div><div class="stat-label">‚è≥ ‡∏ô‡∏≤‡∏ó‡∏µ‡∏£‡∏≠‡∏£‡∏ß‡∏°</div></div>
  </div>

  <div class="section-card">
    <div class="section-title"><span>üí¥</span>‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</div>
    <div id="expense-summary"><div class="empty-state" style="padding:18px 0"><p style="font-size:13px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p></div></div>
  </div>

  <div class="section-card">
    <div class="section-title"><span>üåü</span>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô/‡πÇ‡∏ä‡∏ß‡πå‡∏î‡∏≤‡∏ß‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</div>
    <div id="top-rides"><div class="empty-state" style="padding:14px 0"><p style="font-size:13px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p></div></div>
  </div>

  <div class="section-card">
    <div class="section-title"><span>üóëÔ∏è</span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
    <button class="btn btn-secondary" style="color:#e53935" onclick="clearAll()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
  </div>
</div>

<!-- ===== PAGE: EXPORT ===== -->
<div class="page" id="page-export">
  <div class="section-card">
    <div class="section-title"><span>üì§</span>Export & Share</div>
    <p style="font-size:13px;color:var(--gray);margin-bottom:13px">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ä‡∏£‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å</p>
    <div class="export-preview" id="export-text">‡∏Å‡∏î "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</div>
    <button class="btn btn-primary" onclick="generateExport()" style="margin-bottom:9px">‚ú® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ</button>
    <button class="btn btn-teal" onclick="copyExport()">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// ========== DATA ==========
const RIDES_DATA = [
  // World Bazaar
  {name:"Omnibus", zone:"World Bazaar", wait:"walk-in", note:"‡∏£‡∏ñ‡∏ö‡∏±‡∏™‡∏™‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô‡∏ä‡∏°‡∏ß‡∏¥‡∏ß"},
  {name:"Penny Arcade", zone:"World Bazaar", wait:"-", note:"‡∏ï‡∏π‡πâ‡πÄ‡∏Å‡∏°‡∏´‡∏¢‡∏≠‡∏î‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏¢‡πâ‡∏≠‡∏ô‡∏¢‡∏∏‡∏Ñ"},
  // Adventureland
  {name:"Western River Railroad", zone:"Adventureland", wait:"15-25", note:"‡∏£‡∏ñ‡πÑ‡∏ü‡∏´‡∏±‡∏ß‡∏à‡∏±‡∏Å‡∏£‡πÑ‡∏≠‡∏ô‡πâ‡∏≥"},
  {name:"Pirates of the Caribbean", zone:"Adventureland", wait:"15-20", note:"‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡πÇ‡∏à‡∏£‡∏™‡∏•‡∏±‡∏î"},
  {name:"Jungle Cruise: Wildlife Expeditions", zone:"Adventureland", wait:"20-40", note:"‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ú‡∏à‡∏ç‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏õ‡πà‡∏≤"},
  {name:"Swiss Family Treehouse", zone:"Adventureland", wait:"-", note:"‚ö†Ô∏è ‡∏õ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á 27 ‡∏°‡∏µ.‡∏Ñ. 2026"},
  {name:"The Enchanted Tiki Room (Stitch)", zone:"Adventureland", wait:"5-15", note:"‡πÇ‡∏ä‡∏ß‡πå‡∏ô‡∏Å‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏•‡∏á"},
  // Westernland
  {name:"Westernland Shootin' Gallery", zone:"Westernland", wait:"-", note:"‡πÄ‡∏Å‡∏°‡∏¢‡∏¥‡∏á‡∏õ‡∏∑‡∏ô (‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°)"},
  {name:"Country Bear Theater", zone:"Westernland", wait:"5-15", note:"‡πÇ‡∏ä‡∏ß‡πå‡∏´‡∏°‡∏µ‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏•‡∏á"},
  {name:"Mark Twain Riverboat", zone:"Westernland", wait:"10-15", note:"‡πÄ‡∏£‡∏∑‡∏≠‡∏™‡∏≥‡∏£‡∏≤‡∏ç‡∏•‡∏≥‡πÉ‡∏´‡∏ç‡πà"},
  {name:"Tom Sawyer Island Rafts", zone:"Westernland", wait:"-", note:"‡πÅ‡∏û‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡πÄ‡∏Å‡∏≤‡∏∞"},
  {name:"Big Thunder Mountain", zone:"Westernland", wait:"35-55", note:"üéüÔ∏è Priority Pass"},
  // Critter Country
  {name:"Splash Mountain", zone:"Critter Country", wait:"45-70", note:"üí≥ DPA (Disney Premier Access)"},
  {name:"Beaver Brothers Explorer Canoes", zone:"Critter Country", wait:"10-20", note:"‡∏û‡∏≤‡∏¢‡πÄ‡∏£‡∏∑‡∏≠‡πÅ‡∏Ñ‡∏ô‡∏π"},
  // Fantasyland
  {name:"Enchanted Tale of Beauty and the Beast", zone:"Fantasyland", wait:"70-120", note:"üí≥ DPA ‚Äî ‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î"},
  {name:"Alice's Tea Party", zone:"Fantasyland", wait:"10-15", note:"‡∏ñ‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≥‡∏ä‡∏≤‡∏´‡∏°‡∏∏‡∏ô"},
  {name:"it's a small world (with Groot)", zone:"Fantasyland", wait:"15-25", note:"üåø ‡∏ò‡∏µ‡∏° Marvel ‡∏ñ‡∏∂‡∏á ‡∏°‡∏¥.‡∏¢. 2026"},
  {name:"Castle Carrousel", zone:"Fantasyland", wait:"10-15", note:"‡∏°‡πâ‡∏≤‡∏´‡∏°‡∏∏‡∏ô"},
  {name:"Snow White's Adventures", zone:"Fantasyland", wait:"15-20", note:""},
  {name:"Cinderella's Fairy Tale Hall", zone:"Fantasyland", wait:"15-25", note:"‡πÄ‡∏î‡∏¥‡∏ô‡∏ä‡∏°‡πÉ‡∏ô‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó"},
  {name:"Dumbo the Flying Elephant", zone:"Fantasyland", wait:"20-35", note:"‚ö†Ô∏è ‡∏õ‡∏¥‡∏î 5 ‡∏°.‡∏Ñ. - 31 ‡∏Å.‡∏Ñ. 2026"},
  {name:"Peter Pan's Flight", zone:"Fantasyland", wait:"30-45", note:""},
  {name:"Pinocchio's Daring Journey", zone:"Fantasyland", wait:"15-20", note:""},
  {name:"Pooh's Hunny Hunt", zone:"Fantasyland", wait:"35-60", note:"üéüÔ∏è Priority Pass"},
  {name:"Haunted Mansion", zone:"Fantasyland", wait:"30-50", note:"üéüÔ∏è Priority Pass"},
  {name:"Mickey's PhilharMagic", zone:"Fantasyland", wait:"10-15", note:"‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ï 3D"},
  // Toontown
  {name:"Gadget's Go Coaster", zone:"Toontown", wait:"15-25", note:"‡∏£‡∏ñ‡πÑ‡∏ü‡πÄ‡∏´‡∏≤‡∏∞‡πÄ‡∏î‡πá‡∏Å"},
  {name:"Goofy's Paint 'n' Play House", zone:"Toontown", wait:"10-15", note:""},
  {name:"Chip 'n Dale's Treehouse", zone:"Toontown", wait:"-", note:""},
  {name:"Toon Park", zone:"Toontown", wait:"-", note:"‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πà‡∏ô"},
  {name:"Donald's Boat", zone:"Toontown", wait:"-", note:""},
  {name:"Minnie's House", zone:"Toontown", wait:"15-30", note:"‡πÄ‡∏î‡∏¥‡∏ô‡∏ä‡∏°‡∏ö‡πâ‡∏≤‡∏ô‡∏°‡∏¥‡∏ô‡∏ô‡∏µ‡πà"},
  {name:"Roger Rabbit's Car Toon Spin", zone:"Toontown", wait:"20-35", note:""},
  {name:"Mickey's House & Meet Mickey", zone:"Toontown", wait:"30-60", note:"‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏Å‡∏±‡∏ö‡∏°‡∏¥‡∏Å‡∏Å‡∏µ‡πâ"},
  // Tomorrowland
  {name:"Star Tours: The Adventures Continue", zone:"Tomorrowland", wait:"15-30", note:""},
  {name:"Stitch Encounter", zone:"Tomorrowland", wait:"10-20", note:""},
  {name:"The Happy Ride with Baymax", zone:"Tomorrowland", wait:"45-80", note:"üí≥ DPA"},
  {name:"Monsters, Inc. Ride & Go Seek!", zone:"Tomorrowland", wait:"40-60", note:"üéüÔ∏è Priority Pass"},
  {name:"Space Mountain", zone:"Tomorrowland", wait:"-", note:"‚ö†Ô∏è ‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡∏°‡πà 2027"},
];

const SHOWS_DATA = [
  {name:"Disney Harmony in Color (Daytime Parade)", zone:"Parade", note:"üí≥ DPA / ‡∏û‡∏≤‡πÄ‡∏´‡∏£‡∏î‡∏™‡∏µ‡∏™‡∏±‡∏ô‡∏™‡∏î‡πÉ‡∏™"},
  {name:"Electrical Parade Dreamlights (Night Parade)", zone:"Parade", note:"üí≥ DPA / ‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏¥‡∏Å‡πÑ‡∏ü‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡∏û‡∏•‡∏≤‡∏î"},
  {name:"Reach for the Stars (Castle Projection)", zone:"Fantasyland", note:"üí≥ DPA / ‡πÇ‡∏î‡∏£‡∏ô+‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÑ‡∏ü"},
  {name:"Mickey's Magical Music World", zone:"Fantasyland Forest Theatre", note:"Entry Request / ‡πÇ‡∏ä‡∏ß‡πå‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏µ‡πÅ‡∏≠‡∏£‡πå"},
  {name:"Club Mouse Beat", zone:"Showbase Tomorrowland", note:"Entry Request / ‡∏°‡∏¥‡∏Å‡∏Å‡∏µ‡πâ‡πÄ‡∏ï‡πâ‡∏ô‡πÅ‡∏ô‡∏ß‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢"},
  {name:"Jamboree Mickey! Let's Dance!", zone:"Theatre Orleans", note:"Entry Request / ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å"},
  {name:"Sky Full of Colors (Fireworks)", zone:"‡∏ó‡∏±‡πà‡∏ß‡∏™‡∏ß‡∏ô‡∏™‡∏ô‡∏∏‡∏Å", note:"‡∏ä‡∏°‡∏ü‡∏£‡∏µ / ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 20:25 ‡∏ô."},
  {name:"The Diamond Horseshoe Show", zone:"Westernland", note:"‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≠‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ / ‡∏ó‡∏≤‡∏ô‡∏™‡πÄ‡∏ï‡πá‡∏Å‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÇ‡∏ä‡∏ß‡πå‡∏Ñ‡∏≤‡∏ß‡∏ö‡∏≠‡∏¢"},
  {name:"Polynesian Terrace Show", zone:"Adventureland", note:"‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≠‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ / ‡πÇ‡∏ä‡∏ß‡πå‡∏£‡∏∞‡∏ö‡∏≥‡∏Æ‡∏≤‡∏ß‡∏≤‡∏¢"},
  {name:"The Enchanted Tiki Room", zone:"Adventureland", note:"Walk-in / ‡πÇ‡∏ä‡∏ß‡πå‡∏ô‡∏Å‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡∏∞ Stitch"},
  {name:"Country Bear Theater", zone:"Westernland", note:"Walk-in / ‡∏°‡∏µ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ï‡∏≤‡∏°‡∏§‡∏î‡∏π‡∏Å‡∏≤‡∏•"},
  {name:"Atmosphere Entertainment (‡∏î‡∏ô‡∏ï‡∏£‡∏µ‡∏™‡∏î)", zone:"‡∏ó‡∏±‡πà‡∏ß‡∏™‡∏ß‡∏ô‡∏™‡∏ô‡∏∏‡∏Å", note:"‡∏û‡∏ö‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏à‡∏∏‡∏î‡∏ï‡πà‡∏≤‡∏á‡πÜ"},
  {name:"Minnie's Funderland (Jan-Mar 2026)", zone:"Special Event", note:"üéÄ Event ‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ"},
];

const RESTAURANTS_DATA = [
  {name:"Eastside Cafe", zone:"World Bazaar", type:"‡∏à‡∏≠‡∏á (PS)", note:"Must Try: Pasta Set ‡∏´‡∏ô‡πâ‡∏≤‡∏ã‡∏µ‡∏ü‡∏π‡πâ‡∏î"},
  {name:"Center Street Coffeehouse", zone:"World Bazaar", type:"‡∏à‡∏≠‡∏á (PS)", note:"Must Try: Mickey Mouse Iced Cafe Latte"},
  {name:"Restaurant Hokusai", zone:"World Bazaar", type:"‡∏à‡∏≠‡∏á (PS)", note:"Must Try: Tempura Set ‡∏Å‡∏∏‡πâ‡∏á‡∏ï‡∏±‡∏ß‡πÇ‡∏ï"},
  {name:"Crystal Palace", zone:"World Bazaar", type:"‡∏à‡∏≠‡∏á (PS)", note:"‡∏ö‡∏∏‡∏ü‡πÄ‡∏ü‡πà‡∏ï‡πå / Must Try: ‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô"},
  {name:"Blue Bayou", zone:"Adventureland", type:"‡∏à‡∏≠‡∏á (PS)", note:"Must Try: Blue Bayou Steak Course"},
  {name:"The Diamond Horseshoe", zone:"Westernland", type:"‡∏à‡∏≠‡∏á (PS)", note:"Must Try: Combo Steak Set + ‡πÇ‡∏ä‡∏ß‡πå‡∏Ñ‡∏≤‡∏ß‡∏ö‡∏≠‡∏¢"},
  {name:"Polynesian Terrace", zone:"Adventureland", type:"‡∏à‡∏≠‡∏á (PS)", note:"Must Try: Mickey-shaped Pancakes"},
  {name:"Queen of Hearts", zone:"Fantasyland", type:"Walk-in", note:"Must Try: Flank Steak ‡∏£‡∏π‡∏õ‡∏´‡∏±‡∏ß‡πÉ‡∏à"},
  {name:"Hungry Bear", zone:"Critter Country", type:"Walk-in", note:"Must Try: Pork Cutlet Curry ‡∏à‡∏≤‡∏ô‡∏¢‡∏±‡∏Å‡∏©‡πå"},
  {name:"China Voyager", zone:"Adventureland", type:"Walk-in", note:"Must Try: Black Pepper Pork Noodles"},
  {name:"Grandma Sara's", zone:"Westernland", type:"Walk-in", note:"Must Try: Omurice with Seafood Cream Sauce"},
  {name:"La Taverne de Gaston", zone:"Fantasyland", type:"Mobile Order", note:"Must Try: Big Bite Croissant ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏±‡∏Å‡∏©‡πå"},
  {name:"Pan Galactic Pizza", zone:"Tomorrowland", type:"Mobile Order", note:"Must Try: Little Green Dumplings (‡πÇ‡∏°‡∏à‡∏¥‡πÄ‡∏≠‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏ô)"},
  {name:"Plazma Ray's Diner", zone:"Tomorrowland", type:"Mobile Order", note:"Must Try: Rice Bowl with Chicken and Egg"},
  {name:"Great American Waffle Co.", zone:"World Bazaar", type:"Walk-in", note:"Must Try: Mickey Waffle with Maple Sauce"},
  {name:"Camp Woodchuck Kitchen", zone:"Toontown", type:"Walk-in", note:"Must Try: Smoked Turkey Leg"},
  {name:"Sweetheart Cafe", zone:"Fantasyland", type:"Walk-in", note:"Must Try: Mickey-shaped Danish"},
  {name:"Captain Hook's Galley", zone:"Fantasyland", type:"Walk-in", note:"Must Try: Seafood Pizza"},
  {name:"Huey, Dewey & Louie's Good Time Cafe", zone:"Toontown", type:"Walk-in", note:"Must Try: Mickey Glove Chicken Pau"},
  {name:"Tomorrowland Terrace", zone:"Tomorrowland", type:"Mobile Order", note:"Must Try: Mickey-shaped Chicken Nuggets"},
  {name:"Cafe Orleans", zone:"Adventureland", type:"Walk-in", note:"Must Try: Strawberry and Custard Crepe"},
  {name:"Troubadour Tavern", zone:"Fantasyland", type:"Walk-in", note:"Soft Serve with Seasonal Toppings"},
  {name:"Ice Cream Cones", zone:"World Bazaar", type:"Walk-in", note:"Double Scoop Cone"},
  {name:"Pecos Bill Cafe", zone:"Westernland", type:"Walk-in", note:"Churros (Cinnamon/Chocolate)"},
  {name:"Rackety's Raccoon Saloon", zone:"Critter Country", type:"Walk-in", note:"Critter Sundae ‡πÑ‡∏≠‡∏®‡∏Å‡∏£‡∏µ‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏π‡πÇ‡∏£‡∏™"},
  {name:"The Big Pop (Popcorn)", zone:"Tomorrowland", type:"Walk-in", note:"Baymax Popcorn Bucket"},
  {name:"Soft Landing", zone:"Tomorrowland", type:"Walk-in", note:"Alien Mochi Soft Serve"},
  {name:"Village Pastry", zone:"Fantasyland", type:"Walk-in", note:"Chai Tea flavored snacks"},
  {name:"Good Time Cafe", zone:"Toontown", type:"Walk-in", note:"Mickey Mouse Shaped Pizza"},
  {name:"Dinghy Drinks", zone:"Adventureland", type:"Walk-in", note:"Seasonal Fruit Drinks"},
  {name:"The Gazebo", zone:"Adventureland", type:"Walk-in", note:"Must Try: Beef and Vegetable Soup (‡∏î‡∏µ‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏ô‡∏≤‡∏ß)"},
  {name:"Popcorn Wagons", zone:"‡∏ó‡∏±‡πà‡∏ß‡∏™‡∏ß‡∏ô", type:"‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô", note:"Soy Sauce & Butter / Curry Popcorn"},
];

const MENUS_DATA = {
  "Eastside Cafe":["‡∏û‡∏≤‡∏™‡∏ï‡πâ‡∏≤‡πÄ‡∏ã‡πá‡∏ï Seafood","‡∏™‡∏•‡∏±‡∏î","‡∏Ç‡∏ô‡∏°‡∏´‡∏ß‡∏≤‡∏ô‡∏≠‡∏¥‡∏ï‡∏≤‡πÄ‡∏•‡∏µ‡∏¢‡∏ô","‡πÑ‡∏ß‡∏ô‡πå"],
  "Center Street Coffeehouse":["‡∏™‡πÄ‡∏ï‡πá‡∏Å‡πÄ‡∏ã‡πá‡∏ï","Omurice (‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡πà‡∏≠‡πÑ‡∏Ç‡πà)","Mickey Mouse Iced Cafe Latte","‡∏Å‡∏≤‡πÅ‡∏ü‡∏•‡∏≤‡πÄ‡∏ï‡πâ‡∏≠‡∏≤‡∏£‡πå‡∏ï"],
  "Restaurant Hokusai":["Tempura Set","‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏•‡∏≤‡πÑ‡∏´‡∏•","‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏•‡∏≤‡∏î‡∏¥‡∏ö","‡∏≠‡∏∏‡∏î‡πâ‡∏á"],
  "Crystal Palace":["‡∏ö‡∏∏‡∏ü‡πÄ‡∏ü‡πà‡∏ï‡πå‡∏ô‡∏≤‡∏ô‡∏≤‡∏ä‡∏≤‡∏ï‡∏¥","‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô","‡∏ú‡∏•‡πÑ‡∏°‡πâ"],
  "Blue Bayou":["Blue Bayou Steak Course","Appetizer","Main Course","Dessert"],
  "The Diamond Horseshoe":["Combo Steak Set","‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å","‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô‡∏£‡∏π‡∏õ‡πÄ‡∏Å‡∏∑‡∏≠‡∏Å‡∏°‡πâ‡∏≤"],
  "Polynesian Terrace":["Mickey-shaped Pancakes","‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Æ‡∏≤‡∏ß‡∏≤‡∏¢","‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏ó‡∏£‡∏≠‡∏õ‡∏¥‡∏Ñ‡∏≠‡∏•"],
  "Queen of Hearts":["Flank Steak (Heart shaped)","‡πÑ‡∏Å‡πà‡∏≠‡∏ö","‡∏õ‡∏•‡∏≤‡∏ó‡∏≠‡∏î","‡∏ã‡∏∏‡∏õ‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î","‡πÄ‡∏Ñ‡πâ‡∏Å"],
  "Hungry Bear":["Pork Cutlet Curry","‡πÅ‡∏Å‡∏á‡∏Å‡∏∞‡∏´‡∏£‡∏µ‡πà‡πÑ‡∏Å‡πà","‡πÅ‡∏Æ‡∏°‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏Å","‡∏™‡∏•‡∏±‡∏î"],
  "China Voyager":["Black Pepper Pork Noodles","‡∏£‡∏≤‡πÄ‡∏°‡∏á‡∏Å‡∏∏‡πâ‡∏á","‡∏ï‡∏¥‡πà‡∏°‡∏ã‡∏≥","‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏î‡πá‡∏Å"],
  "Grandma Sara's":["Omurice with Seafood Cream Sauce","‡∏™‡∏ï‡∏π‡∏ß‡πå‡πÄ‡∏ô‡∏∑‡πâ‡∏≠","‡∏û‡∏≤‡∏¢‡πÑ‡∏Å‡πà"],
  "La Taverne de Gaston":["Big Bite Croissant ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏±‡∏Å‡∏©‡πå","‡∏Ñ‡∏£‡∏±‡∏ß‡∏ã‡∏≠‡∏á‡∏ï‡πå‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å","‡∏û‡∏≤‡∏¢‡πÄ‡∏ô‡∏∑‡πâ‡∏≠","‡πÄ‡∏ü‡∏£‡∏ô‡∏ä‡πå‡πÇ‡∏ó‡∏™‡∏ï‡πå"],
  "Pan Galactic Pizza":["Little Green Dumplings (‡πÇ‡∏°‡∏à‡∏¥‡πÄ‡∏≠‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏ô)","‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ"],
  "Plazma Ray's Diner":["Rice Bowl with Chicken and Egg","‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏Å‡∏Å‡∏µ‡πâ","‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡πá‡∏ï"],
  "Great American Waffle Co.":["Mickey Waffle with Maple Sauce","‡∏ß‡∏≤‡∏ü‡πÄ‡∏ü‡∏¥‡∏•‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï","‡∏ß‡∏≤‡∏ü‡πÄ‡∏ü‡∏¥‡∏•‡∏Ñ‡∏±‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏î"],
  "Camp Woodchuck Kitchen":["Smoked Turkey Leg","‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä‡πÑ‡∏Å‡πà‡∏ó‡∏≠‡∏î","‡∏û‡∏≤‡∏¢‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï"],
  "Sweetheart Cafe":["Mickey-shaped Danish","‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä‡∏°‡∏¥‡∏Å‡∏Å‡∏µ‡πâ","‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ","‡∏û‡∏≤‡∏™‡∏ó‡∏£‡∏µ"],
  "Captain Hook's Galley":["Seafood Pizza","‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏ñ‡∏≤‡∏î‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô","‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°"],
  "Huey, Dewey & Louie's Good Time Cafe":["Mickey Glove Chicken Pau","‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏¥‡∏Å‡∏Å‡∏µ‡πâ","‡∏™‡∏•‡∏±‡∏î"],
  "Tomorrowland Terrace":["Mickey-shaped Chicken Nuggets","‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏Å‡∏≠‡∏£‡πå‡πÄ‡∏ô‡∏∑‡πâ‡∏≠","‡πÄ‡∏ü‡∏£‡∏ô‡∏ä‡πå‡∏ü‡∏£‡∏≤‡∏¢‡∏™‡πå"],
  "Cafe Orleans":["Strawberry and Custard Crepe","‡πÄ‡∏Ñ‡∏£‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏≤‡∏ß‡∏ã‡∏µ‡∏ü‡∏π‡πâ‡∏î"],
  "Troubadour Tavern":["Soft Serve Seasonal","‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏§‡∏î‡∏π‡∏Å‡∏≤‡∏•"],
  "Ice Cream Cones":["Double Scoop Cone","‡∏ã‡∏±‡∏ô‡πÄ‡∏î‡∏ú‡∏•‡πÑ‡∏°‡πâ"],
  "Pecos Bill Cafe":["Churros Cinnamon","Churros Chocolate","‡∏Ç‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏™‡πÄ‡∏ú‡πá‡∏î"],
  "Rackety's Raccoon Saloon":["Critter Sundae","‡∏ä‡∏π‡πÇ‡∏£‡∏™‡∏£‡∏™‡πÄ‡∏°‡πÄ‡∏õ‡∏¥‡πâ‡∏•","‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°"],
  "The Big Pop (Popcorn)":["Baymax Popcorn Bucket","Caramel Popcorn","Cheese Popcorn","Cookie & Cream Popcorn"],
  "Soft Landing":["Alien Mochi Soft Serve","‡πÑ‡∏≠‡∏®‡∏Å‡∏£‡∏µ‡∏°‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü"],
  "Village Pastry":["Chai Tea flavored snacks","‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏ö"],
  "Good Time Cafe":["Mickey Mouse Shaped Pizza","‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏Å‡∏≠‡∏£‡πå","‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä"],
  "Dinghy Drinks":["Seasonal Fruit Drinks","‡∏ô‡πâ‡∏≥‡∏≠‡∏±‡∏î‡∏•‡∏°"],
  "The Gazebo":["Beef and Vegetable Soup","‡∏Ç‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏§‡∏î‡∏π‡∏Å‡∏≤‡∏•"],
  "Popcorn Wagons":["Soy Sauce & Butter Popcorn","Curry Popcorn"],
};

const RATING_LABELS = ['','‡∏ô‡πà‡∏≤‡πÄ‡∏ö‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏¢ üò¥','‡∏û‡∏≠‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ üòê','‡∏î‡∏µ üòä','‡∏î‡∏µ‡∏°‡∏≤‡∏Å üòÑ','‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ü§©'];

// ========== STATE ==========
let logs = JSON.parse(localStorage.getItem('tdl_logs') || '[]');
let expenses = JSON.parse(localStorage.getItem('tdl_expenses') || '[]');
let currentType = 'ride';
let stars = {ride:0, show:0, food:0};
let feelings = {ride:'', show:''};
let selectedRideZone = '';
let selectedRideName = '';
let selectedFoodZone = '';
let selectedFoodRestaurant = '';
let selectedFoodMenu = '';
let foodCurrency = 'yen';
let expCurrency = 'yen';
let exchangeRate = parseFloat(localStorage.getItem('tdl_rate') || '0.23');
let rideOrderCount = logs.filter(l=>l.type==='ride').length;

// ========== INIT ==========
function init() {
  const now = new Date();
  document.getElementById('currentDate').textContent =
    now.toLocaleDateString('th-TH',{weekday:'long',year:'numeric',month:'long',day:'numeric'});
  const t = now.toTimeString().slice(0,5);
  ['ride-time','show-time','food-time','exp-time'].forEach(id => {
    const el = document.getElementById(id);
    if(el) el.value = t;
  });
  document.getElementById('rate-display').textContent = exchangeRate;
  renderShowOptions();
  renderTimeline();
  renderSummary();
}

// ========== TABS ==========
function showTab(name) {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('page-'+name).classList.add('active');
  document.getElementById('tab-'+name).classList.add('active');
  if(name==='timeline') renderTimeline();
  if(name==='summary') renderSummary();
}

// ========== TYPE SELECTOR ==========
function selectType(type) {
  currentType = type;
  ['ride','show','food','expense'].forEach(t => {
    document.getElementById('form-'+t).style.display = t===type?'block':'none';
    const btn = document.getElementById('type-'+t);
    btn.className = 'type-btn' + (t===type ? ' active-'+t : '');
  });
}

// ========== RIDE ZONE & SELECTION ==========
function selectRideZone(zone) {
  selectedRideZone = zone;
  selectedRideName = '';
  document.querySelectorAll('#ride-zone-grid .zone-pill').forEach(p => {
    p.classList.toggle('selected', p.textContent.includes(zone));
  });
  document.getElementById('ride-zone-label').textContent = zone;
  document.getElementById('ride-step2').style.display = 'block';
  document.getElementById('ride-details').style.display = 'none';

  const rides = RIDES_DATA.filter(r => r.zone === zone);
  const list = document.getElementById('ride-option-list');
  list.innerHTML = rides.map(r => `
    <div class="ride-option" onclick="selectRide('${r.name.replace(/'/g,"\\'")}')">
      <div class="ride-option-name">${r.name}</div>
      <div class="ride-option-meta">
        ${r.wait && r.wait !== '-' && r.wait !== 'walk-in' ? `<span class="wait-badge">‚è≥ ${r.wait} ‡∏ô.</span>` : ''}
        ${r.note ? `<span class="status-badge">${r.note}</span>` : ''}
      </div>
    </div>
  `).join('') + `
    <div class="ride-option" onclick="document.getElementById('ride-name-custom').style.display='block';document.getElementById('ride-name-custom').focus()">
      <div class="ride-option-name">‚úèÔ∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏á...</div>
    </div>
  `;
  list.scrollIntoView({behavior:'smooth', block:'nearest'});
}

function resetRideZone() {
  selectedRideZone = ''; selectedRideName = '';
  document.getElementById('ride-step2').style.display = 'none';
  document.getElementById('ride-details').style.display = 'none';
  document.getElementById('ride-name-custom').style.display = 'none';
  document.querySelectorAll('#ride-zone-grid .zone-pill').forEach(p => p.classList.remove('selected'));
}

function selectRide(name) {
  selectedRideName = name;
  document.querySelectorAll('#ride-option-list .ride-option').forEach(o => {
    o.classList.toggle('selected', o.querySelector('.ride-option-name').textContent === name);
  });
  document.getElementById('ride-details').style.display = 'block';
  document.getElementById('ride-details').scrollIntoView({behavior:'smooth', block:'nearest'});
}

// ========== SHOW OPTIONS ==========
function renderShowOptions() {
  const list = document.getElementById('show-option-list');
  list.innerHTML = SHOWS_DATA.map(s => `
    <div class="ride-option" onclick="selectShow('${s.name.replace(/'/g,"\\'")}')">
      <div class="ride-option-name">${s.name}</div>
      <div class="ride-option-meta"><span class="status-badge">${s.note}</span></div>
    </div>
  `).join('');
}

function selectShow(name) {
  document.querySelectorAll('#show-option-list .ride-option').forEach(o => {
    o.classList.toggle('selected', o.querySelector('.ride-option-name').textContent === name);
  });
  document.getElementById('show-name-custom').value = name;
}

// ========== FOOD ZONE & SELECTION ==========
function selectFoodZone(zone) {
  selectedFoodZone = zone;
  selectedFoodRestaurant = ''; selectedFoodMenu = '';
  document.querySelectorAll('#food-zone-grid .zone-pill').forEach(p => {
    p.classList.toggle('selected', p.textContent.includes(zone));
  });
  document.getElementById('food-zone-label').textContent = zone;
  document.getElementById('food-step2').style.display = 'block';
  document.getElementById('food-step3').style.display = 'none';
  document.getElementById('food-details').style.display = 'none';

  const rests = RESTAURANTS_DATA.filter(r => r.zone === zone);
  const list = document.getElementById('food-option-list');
  list.innerHTML = rests.map(r => `
    <div class="ride-option food-option" onclick="selectFoodRestaurant('${r.name.replace(/'/g,"\\'")}')">
      <div class="ride-option-name">${r.name}</div>
      <div class="ride-option-meta">
        <span class="status-badge">${r.type}</span>
        <span style="font-size:11px;color:var(--gray)">${r.note}</span>
      </div>
    </div>
  `).join('') + `
    <div class="ride-option food-option" onclick="selectFoodRestaurant('__custom__')">
      <div class="ride-option-name">‚úèÔ∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏≠‡∏á...</div>
    </div>
  `;
  list.scrollIntoView({behavior:'smooth', block:'nearest'});
}

function resetFoodZone() {
  selectedFoodZone = ''; selectedFoodRestaurant = ''; selectedFoodMenu = '';
  document.getElementById('food-step2').style.display = 'none';
  document.getElementById('food-step3').style.display = 'none';
  document.getElementById('food-details').style.display = 'none';
  document.querySelectorAll('#food-zone-grid .zone-pill').forEach(p => p.classList.remove('selected'));
}

function selectFoodRestaurant(name) {
  if(name === '__custom__') {
    const n = prompt('‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£:');
    if(!n) return;
    selectedFoodRestaurant = n;
    showFoodMenus(n);
    return;
  }
  selectedFoodRestaurant = name;
  document.querySelectorAll('#food-option-list .ride-option').forEach(o => {
    o.classList.toggle('selected', o.querySelector('.ride-option-name').textContent === name);
  });
  showFoodMenus(name);
}

function showFoodMenus(restName) {
  document.getElementById('food-step3').style.display = 'block';
  const menus = MENUS_DATA[restName] || [];
  const list = document.getElementById('food-menu-list');
  const customInput = document.getElementById('food-menu-custom');

  if(menus.length === 0) {
    list.innerHTML = '';
    customInput.style.display = 'block';
    customInput.focus();
    document.getElementById('food-details').style.display = 'block';
    return;
  }
  customInput.style.display = 'none';
  list.innerHTML = menus.map(m => `
    <div class="ride-option food-option" onclick="selectFoodMenu('${m.replace(/'/g,"\\'")}')">
      <div class="ride-option-name">${m}</div>
    </div>
  `).join('') + `
    <div class="ride-option food-option" onclick="document.getElementById('food-menu-custom').style.display='block';document.getElementById('food-menu-custom').focus()">
      <div class="ride-option-name">‚úèÔ∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏≠‡∏á...</div>
    </div>
  `;
  list.scrollIntoView({behavior:'smooth', block:'nearest'});
}

function resetFoodRestaurant() {
  selectedFoodRestaurant = ''; selectedFoodMenu = '';
  document.getElementById('food-step3').style.display = 'none';
  document.getElementById('food-details').style.display = 'none';
  document.querySelectorAll('#food-option-list .ride-option').forEach(o => o.classList.remove('selected'));
}

function selectFoodMenu(menu) {
  selectedFoodMenu = menu;
  document.querySelectorAll('#food-menu-list .ride-option').forEach(o => {
    o.classList.toggle('selected', o.querySelector('.ride-option-name').textContent === menu);
  });
  document.getElementById('food-details').style.display = 'block';
  document.getElementById('food-details').scrollIntoView({behavior:'smooth', block:'nearest'});
}

// ========== STARS ==========
function setStars(n, type) {
  stars[type] = n;
  document.querySelectorAll('#'+type+'-stars .star-btn').forEach((b,i) => b.classList.toggle('active', i < n));
  document.getElementById(type+'-rating-label').textContent = RATING_LABELS[n];
}

// ========== FEELINGS ==========
function setFeeling(type, emoji, label) {
  feelings[type] = emoji;
  document.querySelectorAll('#'+type+'-feelings .feeling-btn').forEach(b => {
    const isThis = b.querySelector('.f-emoji').textContent === emoji;
    b.classList.toggle('active', isThis);
  });
}

// ========== WAIT ==========
function updateWait(v) {
  document.getElementById('wait-val').textContent = v;
  document.getElementById('wait-show').textContent =
    v==0 ? '‡πÑ‡∏°‡πà‡∏£‡∏≠‡πÄ‡∏•‡∏¢ üéâ' : v+'‡∏ô‡∏≤‡∏ó‡∏µ'+(v>=60?' ('+Math.floor(v/60)+'‡∏ä‡∏°.'+(v%60?v%60+'‡∏ô.':'')+')'  :'');
}

// ========== CURRENCY ==========
function setFoodCur(cur) {
  foodCurrency = cur;
  document.getElementById('food-cur-yen').classList.toggle('active', cur==='yen');
  document.getElementById('food-cur-thb').classList.toggle('active', cur==='thb');
  updateFoodConverted();
}
function setExpCur(cur) {
  expCurrency = cur;
  document.getElementById('exp-cur-yen').classList.toggle('active', cur==='yen');
  document.getElementById('exp-cur-thb').classList.toggle('active', cur==='thb');
  updateExpConverted();
}
function updateFoodConverted() {
  const v = parseFloat(document.getElementById('food-price').value) || 0;
  const el = document.getElementById('food-converted');
  if(v <= 0) { el.textContent = ''; return; }
  if(foodCurrency === 'yen') el.textContent = `‚âà ${(v * exchangeRate).toFixed(0)} ‡∏ö‡∏≤‡∏ó`;
  else el.textContent = `‚âà ¬•${(v / exchangeRate).toFixed(0)}`;
}
function updateExpConverted() {
  const v = parseFloat(document.getElementById('exp-price').value) || 0;
  const el = document.getElementById('exp-converted');
  if(v <= 0) { el.textContent = ''; return; }
  if(expCurrency === 'yen') el.textContent = `‚âà ${(v * exchangeRate).toFixed(0)} ‡∏ö‡∏≤‡∏ó`;
  else el.textContent = `‚âà ¬•${(v / exchangeRate).toFixed(0)}`;
}
function editRate() {
  const r = prompt('‡πÉ‡∏™‡πà‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô (1 ¬• = ? ‡∏ø):', exchangeRate);
  if(r && !isNaN(r)) {
    exchangeRate = parseFloat(r);
    localStorage.setItem('tdl_rate', exchangeRate);
    document.getElementById('rate-display').textContent = exchangeRate;
    showToast('‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
  }
}

// ========== SAVE FUNCTIONS ==========
function saveRide() {
  const customName = document.getElementById('ride-name-custom').value.trim();
  const name = customName || selectedRideName;
  if(!name) { showToast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô'); return; }
  rideOrderCount++;
  const order = parseInt(document.getElementById('ride-order').value) || rideOrderCount;
  const wait = parseInt(document.getElementById('ride-wait').value) || 0;
  const time = document.getElementById('ride-time').value;
  const note = document.getElementById('ride-note').value.trim();
  logs.push({id:Date.now(), type:'ride', name, zone:selectedRideZone, order, wait, time, stars:stars.ride, feeling:feelings.ride, note, timestamp:Date.now()});
  saveLogs(); resetRideForm();
  showToast('üé¢ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
}

function saveShow() {
  const name = document.getElementById('show-name-custom').value.trim();
  if(!name) { showToast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ä‡∏ß‡πå'); return; }
  const time = document.getElementById('show-time').value;
  const duration = document.getElementById('show-duration').value;
  const note = document.getElementById('show-note').value.trim();
  logs.push({id:Date.now(), type:'show', name, time, duration, stars:stars.show, feeling:feelings.show, note, timestamp:Date.now()});
  saveLogs(); resetShowForm();
  showToast('üé≠ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏ä‡∏ß‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
}

function saveFood() {
  const customMenu = document.getElementById('food-menu-custom').value.trim();
  const menu = customMenu || selectedFoodMenu;
  if(!selectedFoodRestaurant) { showToast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£'); return; }
  const priceRaw = parseFloat(document.getElementById('food-price').value) || 0;
  const time = document.getElementById('food-time').value;
  const note = document.getElementById('food-note').value.trim();
  // Convert to both currencies
  let priceYen, priceThb;
  if(foodCurrency === 'yen') { priceYen = priceRaw; priceThb = priceRaw * exchangeRate; }
  else { priceThb = priceRaw; priceYen = priceRaw / exchangeRate; }
  logs.push({id:Date.now(), type:'food', name:selectedFoodRestaurant, zone:selectedFoodZone, menu, time, priceYen:Math.round(priceYen), priceThb:Math.round(priceThb), stars:stars.food, note, timestamp:Date.now()});
  // Also add to expenses
  if(priceYen > 0) {
    expenses.push({id:Date.now()+1, name:`üçú ${selectedFoodRestaurant}${menu?' - '+menu:''}`, priceYen:Math.round(priceYen), priceThb:Math.round(priceThb), cat:'üçú ‡∏≠‡∏≤‡∏´‡∏≤‡∏£'});
    saveExpenses();
  }
  saveLogs(); resetFoodForm();
  showToast('üçú ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
}

function saveExpense() {
  const name = document.getElementById('exp-name').value.trim();
  const priceRaw = parseFloat(document.getElementById('exp-price').value) || 0;
  if(!name || priceRaw <= 0) { showToast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤'); return; }
  const cat = document.getElementById('exp-cat').value;
  const time = document.getElementById('exp-time').value;
  const note = document.getElementById('exp-note').value.trim();
  let priceYen, priceThb;
  if(expCurrency === 'yen') { priceYen = priceRaw; priceThb = priceRaw * exchangeRate; }
  else { priceThb = priceRaw; priceYen = priceRaw / exchangeRate; }
  expenses.push({id:Date.now(), name, cat, time, note, priceYen:Math.round(priceYen), priceThb:Math.round(priceThb)});
  saveExpenses();
  document.getElementById('exp-name').value = '';
  document.getElementById('exp-price').value = '';
  document.getElementById('exp-note').value = '';
  document.getElementById('exp-converted').textContent = '';
  showToast('üí¥ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
}

// ========== RESET FORMS ==========
function resetRideForm() {
  selectedRideZone = ''; selectedRideName = '';
  document.querySelectorAll('#ride-zone-grid .zone-pill').forEach(p => p.classList.remove('selected'));
  document.getElementById('ride-step2').style.display = 'none';
  document.getElementById('ride-details').style.display = 'none';
  document.getElementById('ride-name-custom').style.display = 'none';
  document.getElementById('ride-name-custom').value = '';
  document.getElementById('ride-wait').value = 0; updateWait(0);
  document.getElementById('ride-order').value = '';
  document.getElementById('ride-note').value = '';
  stars.ride = 0; feelings.ride = '';
  document.querySelectorAll('#ride-stars .star-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('ride-rating-label').textContent = '‡πÅ‡∏ï‡∏∞‡∏î‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô';
  document.querySelectorAll('#ride-feelings .feeling-btn').forEach(b=>b.classList.remove('active'));
  const t = new Date().toTimeString().slice(0,5);
  document.getElementById('ride-time').value = t;
}
function resetShowForm() {
  document.getElementById('show-name-custom').value = '';
  document.getElementById('show-duration').value = '';
  document.getElementById('show-note').value = '';
  stars.show = 0; feelings.show = '';
  document.querySelectorAll('#show-stars .star-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('show-rating-label').textContent = '‡πÅ‡∏ï‡∏∞‡∏î‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô';
  document.querySelectorAll('#show-feelings .feeling-btn').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('#show-option-list .ride-option').forEach(o=>o.classList.remove('selected'));
}
function resetFoodForm() {
  selectedFoodZone = ''; selectedFoodRestaurant = ''; selectedFoodMenu = '';
  document.querySelectorAll('#food-zone-grid .zone-pill').forEach(p=>p.classList.remove('selected'));
  document.getElementById('food-step2').style.display = 'none';
  document.getElementById('food-step3').style.display = 'none';
  document.getElementById('food-details').style.display = 'none';
  document.getElementById('food-price').value = '';
  document.getElementById('food-note').value = '';
  document.getElementById('food-converted').textContent = '';
  document.getElementById('food-menu-custom').value = '';
  stars.food = 0;
  document.querySelectorAll('#food-stars .star-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('food-rating-label').textContent = '‡πÅ‡∏ï‡∏∞‡∏î‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô';
  const t = new Date().toTimeString().slice(0,5);
  document.getElementById('food-time').value = t;
}

// ========== STORAGE ==========
function saveLogs() { localStorage.setItem('tdl_logs', JSON.stringify(logs)); }
function saveExpenses() { localStorage.setItem('tdl_expenses', JSON.stringify(expenses)); }

// ========== TIMELINE ==========
function renderTimeline() {
  const container = document.getElementById('timeline-list');
  const allItems = [
    ...logs.map(l => ({...l, _isLog:true})),
    ...expenses.filter(e=>e.cat!=='üçú ‡∏≠‡∏≤‡∏´‡∏≤‡∏£').map(e => ({...e, type:'expense', _isLog:false}))
  ].sort((a,b) => (a.time||'').localeCompare(b.time||''));

  if(allItems.length === 0) {
    container.innerHTML = `<div class="empty-state"><div class="empty-icon">üè∞</div><p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£<br>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢!</p></div>`;
    return;
  }
  container.innerHTML = `<div class="timeline">${allItems.map(item => timelineItem(item)).join('')}</div>`;
}

function timelineItem(item) {
  const dotClass = {ride:'',show:'show',food:'food',expense:'expense'}[item.type]||'';
  const typeLabel = {ride:'üé¢ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô',show:'üé≠ ‡πÇ‡∏ä‡∏ß‡πå',food:'üçú ‡∏≠‡∏≤‡∏´‡∏≤‡∏£',expense:'üí¥ ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢'}[item.type];
  const typeBadge = {ride:'badge-pink',show:'badge-teal',food:'badge-gold',expense:'badge-purple'}[item.type];
  const stars_str = item.stars ? '‚≠ê'.repeat(item.stars) : '';
  let extra = '';
  if(item.type==='ride') {
    if(item.order) extra += `<span class="badge badge-navy">‡∏•‡∏≥‡∏î‡∏±‡∏ö ${item.order}</span>`;
    if(item.wait>0) extra += `<span class="badge badge-pink">‚è≥${item.wait}‡∏ô.</span>`;
    if(item.zone) extra += `<span class="badge badge-navy">${item.zone}</span>`;
  }
  if(item.type==='food') {
    if(item.menu) extra += `<span class="badge badge-gold">${item.menu}</span>`;
    if(item.priceYen>0) extra += `<span class="badge badge-gold">¬•${item.priceYen.toLocaleString()} (‡∏ø${item.priceThb.toLocaleString()})</span>`;
  }
  if(item.type==='show' && item.duration) extra += `<span class="badge badge-teal">${item.duration}‡∏ô.</span>`;
  if(item.type==='expense') extra += `<span class="badge badge-purple">${item.cat}</span><span class="badge badge-purple">¬•${(item.priceYen||0).toLocaleString()} (‡∏ø${(item.priceThb||0).toLocaleString()})</span>`;

  const isLog = item._isLog !== false;
  return `
    <div class="timeline-item">
      <div class="timeline-dot ${dotClass}"></div>
      <div class="log-item ${item.type}-type">
        <button class="log-delete-btn" onclick="${isLog?'deleteLog':'deleteExpense'}(${item.id})">‚úï</button>
        <div class="log-item-header">
          <div class="log-item-title">${item.name}</div>
          <div class="log-item-time">${item.time||'--:--'}</div>
        </div>
        <div class="log-item-meta">
          <span class="badge ${typeBadge}">${typeLabel}</span>
          ${extra}
          ${stars_str ? `<span style="font-size:12px">${stars_str}</span>` : ''}
          ${item.feeling ? `<span style="font-size:18px">${item.feeling}</span>` : ''}
        </div>
        ${item.note ? `<div class="log-item-note">"${item.note}"</div>` : ''}
      </div>
    </div>`;
}

function deleteLog(id) {
  logs = logs.filter(l=>l.id!==id);
  saveLogs(); renderTimeline(); renderSummary();
  showToast('üóëÔ∏è ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß');
}
function deleteExpense(id) {
  expenses = expenses.filter(e=>e.id!==id);
  saveExpenses(); renderTimeline(); renderSummary();
  showToast('üóëÔ∏è ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß');
}

// ========== SUMMARY ==========
function renderSummary() {
  const rides = logs.filter(l=>l.type==='ride');
  const shows = logs.filter(l=>l.type==='show');
  const food = logs.filter(l=>l.type==='food');
  const totalWait = rides.reduce((s,r)=>s+(r.wait||0),0);
  document.getElementById('stat-rides').textContent = rides.length;
  document.getElementById('stat-shows').textContent = shows.length;
  document.getElementById('stat-food').textContent = food.length;
  document.getElementById('stat-wait').textContent = totalWait;

  // Expenses
  const allExp = [...expenses];
  const totalYen = allExp.reduce((s,e)=>s+(e.priceYen||0),0);
  const totalThb = allExp.reduce((s,e)=>s+(e.priceThb||0),0);
  const catMap = {};
  allExp.forEach(e => {
    const c = e.cat||'üíä ‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
    catMap[c] = (catMap[c]||0) + (e.priceYen||0);
  });
  const expDiv = document.getElementById('expense-summary');
  if(allExp.length===0) {
    expDiv.innerHTML = '<div class="empty-state" style="padding:16px 0"><p style="font-size:13px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p></div>';
  } else {
    let html = '';
    Object.entries(catMap).sort((a,b)=>b[1]-a[1]).forEach(([cat,amt]) => {
      const pct = totalYen>0 ? (amt/totalYen*100) : 0;
      html += `<div class="expense-row"><div class="expense-cat">${cat}</div><div class="expense-amount">¬•${amt.toLocaleString()}</div></div>
        <div class="expense-bar"><div class="expense-fill" style="width:${pct}%"></div></div>`;
    });
    html += `<div class="expense-row" style="margin-top:10px;border-top:2px solid var(--pink);padding-top:10px">
      <div class="expense-cat" style="font-size:15px;color:var(--navy)">üí¥ ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
      <div style="text-align:right"><div class="expense-amount" style="font-size:17px">¬•${totalYen.toLocaleString()}</div>
      <div style="font-size:12px;color:var(--gray)">‡∏ø${Math.round(totalThb).toLocaleString()}</div></div></div>`;
    expDiv.innerHTML = html;
  }

  // Top rides & shows
  const topAll = [...logs].filter(l=>l.stars>0).sort((a,b)=>b.stars-a.stars).slice(0,5);
  const topDiv = document.getElementById('top-rides');
  if(topAll.length===0) {
    topDiv.innerHTML = '<div class="empty-state" style="padding:12px 0"><p style="font-size:13px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p></div>';
  } else {
    topDiv.innerHTML = topAll.map((r,i) => `
      <div class="expense-row">
        <div class="expense-cat">${['ü•á','ü•à','ü•â','4Ô∏è‚É£','5Ô∏è‚É£'][i]} ${r.name}</div>
        <div>${'‚≠ê'.repeat(r.stars)}</div>
      </div>`).join('');
  }
}

// ========== EXPORT ==========
function generateExport() {
  const rides = logs.filter(l=>l.type==='ride').sort((a,b)=>(a.time||'').localeCompare(b.time||''));
  const shows = logs.filter(l=>l.type==='show').sort((a,b)=>(a.time||'').localeCompare(b.time||''));
  const food = logs.filter(l=>l.type==='food').sort((a,b)=>(a.time||'').localeCompare(b.time||''));
  const totalWait = rides.reduce((s,r)=>s+(r.wait||0),0);
  const totalYen = expenses.reduce((s,e)=>s+(e.priceYen||0),0);
  const totalThb = expenses.reduce((s,e)=>s+(e.priceThb||0),0);
  const now = new Date();
  let text = `üè∞ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß Tokyo Disneyland\nüìÖ ${now.toLocaleDateString('th-TH',{year:'numeric',month:'long',day:'numeric'})}\n${'='.repeat(40)}\n\nüé¢ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô (${rides.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)\n${'‚îÄ'.repeat(30)}\n`;
  rides.forEach((r,i) => {
    text += `${i+1}. ${r.name} [${r.time||'--:--'}]${r.zone?' ('+r.zone+')':''}\n`;
    if(r.wait>0) text += `   ‚è≥ ‡∏£‡∏≠: ${r.wait}‡∏ô.\n`;
    if(r.stars>0) text += `   ${'‚≠ê'.repeat(r.stars)} ${RATING_LABELS[r.stars]}\n`;
    if(r.feeling) text += `   ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å: ${r.feeling}\n`;
    if(r.note) text += `   üìù "${r.note}"\n`;
    text += '\n';
  });
  text += `\nüé≠ ‡πÇ‡∏ä‡∏ß‡πå & Parade (${shows.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)\n${'‚îÄ'.repeat(30)}\n`;
  shows.forEach((s,i) => {
    text += `${i+1}. ${s.name} [${s.time||'--:--'}]\n`;
    if(s.stars>0) text += `   ${'‚≠ê'.repeat(s.stars)}\n`;
    if(s.note) text += `   üìù "${s.note}"\n`;
    text += '\n';
  });
  text += `\nüçú ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (${food.length} ‡∏°‡∏∑‡πâ‡∏≠)\n${'‚îÄ'.repeat(30)}\n`;
  food.forEach((f,i) => {
    text += `${i+1}. ${f.name}${f.menu?' - '+f.menu:''} [${f.time||'--:--'}]\n`;
    if(f.priceYen>0) text += `   üí¥ ¬•${f.priceYen.toLocaleString()} (‡∏ø${f.priceThb.toLocaleString()})\n`;
    if(f.stars>0) text += `   ${'‚≠ê'.repeat(f.stars)}\n`;
    if(f.note) text += `   üìù "${f.note}"\n`;
    text += '\n';
  });
  text += `\n${'='.repeat(40)}\nüìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô\nüé¢ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô: ${rides.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\nüé≠ ‡πÇ‡∏ä‡∏ß‡πå: ${shows.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\nüçú ‡∏≠‡∏≤‡∏´‡∏≤‡∏£: ${food.length} ‡∏°‡∏∑‡πâ‡∏≠\n‚è≥ ‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≠‡∏£‡∏ß‡∏°: ${totalWait}‡∏ô.\nüí¥ ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°: ¬•${totalYen.toLocaleString()} (‡∏ø${Math.round(totalThb).toLocaleString()})\n\n‚ú® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ TDL Trip Logger`;
  document.getElementById('export-text').textContent = text;
}

function copyExport() {
  const text = document.getElementById('export-text').textContent;
  if(text.startsWith('‡∏Å‡∏î')) { showToast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ" ‡∏Å‡πà‡∏≠‡∏ô'); return; }
  navigator.clipboard.writeText(text).then(()=>showToast('‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏ä‡∏£‡πå!')).catch(()=>showToast('‚ö†Ô∏è ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'));
}

function clearAll() {
  if(!confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?')) return;
  logs=[]; expenses=[]; rideOrderCount=0;
  saveLogs(); saveExpenses(); renderTimeline(); renderSummary();
  showToast('üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
}

let toastTimer;
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(()=>t.classList.remove('show'), 2500);
}

// Food price input listener
document.addEventListener('DOMContentLoaded', () => {
  const fp = document.getElementById('food-price');
  if(fp) fp.addEventListener('input', updateFoodConverted);
});

init();
</script>
</body>
</html>
